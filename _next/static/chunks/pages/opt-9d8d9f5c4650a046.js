(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[326],{2711:function(e,i,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/opt",function(){return n(4509)}])},9427:function(e,i,n){"use strict";n.d(i,{R2:function(){return r},_4:function(){return o},_X:function(){return s},bW:function(){return l},nr:function(){return c}});var t=n(5893);let s=(0,t.jsx)("svg",{style:{position:"relative",right:"5px",top:" 2px"},xmlns:"http://www.w3.org/2000/svg",height:"1em",viewBox:"0 0 512 512",children:(0,t.jsx)("path",{d:"M320 0c-17.7 0-32 14.3-32 32s14.3 32 32 32h82.7L201.4 265.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L448 109.3V192c0 17.7 14.3 32 32 32s32-14.3 32-32V32c0-17.7-14.3-32-32-32H320zM80 32C35.8 32 0 67.8 0 112V432c0 44.2 35.8 80 80 80H400c44.2 0 80-35.8 80-80V320c0-17.7-14.3-32-32-32s-32 14.3-32 32V432c0 8.8-7.2 16-16 16H80c-8.8 0-16-7.2-16-16V112c0-8.8 7.2-16 16-16H192c17.7 0 32-14.3 32-32s-14.3-32-32-32H80z"})}),l=(0,t.jsx)("svg",{style:{position:"relative",right:"10px",top:" 2px"},xmlns:"http://www.w3.org/2000/svg",height:"1em",viewBox:"0 0 496 512",children:(0,t.jsx)("path",{d:"M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"})}),c=(0,t.jsx)("svg",{fill:"#000000",height:"27px",viewBox:"1 -1 20 20",xmlns:"http://www.w3.org/2000/svg",children:(0,t.jsx)("path",{d:"M11.16 16.153a.477.477 0 0 1-.476.475H1.316a.477.477 0 0 1-.475-.475V3.046a.477.477 0 0 1 .475-.475h6.95l2.893 2.893zm-1.11-9.924H8.059a.575.575 0 0 1-.574-.574V3.679H1.95v11.84h8.102zM3.907 4.92a1.03 1.03 0 1 0 1.029 1.03 1.03 1.03 0 0 0-1.03-1.03zm4.958 3.253h-5.87v1.108h5.87zm0 2.354h-5.87v1.109h5.87zm0 2.354h-5.87v1.109h5.87z"})}),r=(0,t.jsx)("svg",{style:{position:"relative",top:"2px"},xmlns:"http://www.w3.org/2000/svg",height:"1em",viewBox:"0 0 384 512",children:(0,t.jsx)("path",{d:"M272 384c9.6-31.9 29.5-59.1 49.2-86.2l0 0c5.2-7.1 10.4-14.2 15.4-21.4c19.8-28.5 31.4-63 31.4-100.3C368 78.8 289.2 0 192 0S16 78.8 16 176c0 37.3 11.6 71.9 31.4 100.3c5 7.2 10.2 14.3 15.4 21.4l0 0c19.8 27.1 39.7 54.4 49.2 86.2H272zM192 512c44.2 0 80-35.8 80-80V416H112v16c0 44.2 35.8 80 80 80zM112 176c0 8.8-7.2 16-16 16s-16-7.2-16-16c0-61.9 50.1-112 112-112c8.8 0 16 7.2 16 16s-7.2 16-16 16c-44.2 0-80 35.8-80 80z"})}),o=(0,t.jsx)("svg",{style:{position:"relative",top:"2px"},xmlns:"http://www.w3.org/2000/svg",height:"1em",viewBox:"0 0 384 512",children:(0,t.jsx)("path",{d:"M297.2 248.9C311.6 228.3 320 203.2 320 176c0-70.7-57.3-128-128-128S64 105.3 64 176c0 27.2 8.4 52.3 22.8 72.9c3.7 5.3 8.1 11.3 12.8 17.7l0 0c12.9 17.7 28.3 38.9 39.8 59.8c10.4 19 15.7 38.8 18.3 57.5H109c-2.2-12-5.9-23.7-11.8-34.5c-9.9-18-22.2-34.9-34.5-51.8l0 0 0 0c-5.2-7.1-10.4-14.2-15.4-21.4C27.6 247.9 16 213.3 16 176C16 78.8 94.8 0 192 0s176 78.8 176 176c0 37.3-11.6 71.9-31.4 100.3c-5 7.2-10.2 14.3-15.4 21.4l0 0 0 0c-12.3 16.8-24.6 33.7-34.5 51.8c-5.9 10.8-9.6 22.5-11.8 34.5H226.4c2.6-18.7 7.9-38.6 18.3-57.5c11.5-20.9 26.9-42.1 39.8-59.8l0 0 0 0 0 0c4.7-6.4 9-12.4 12.7-17.7zM192 128c-26.5 0-48 21.5-48 48c0 8.8-7.2 16-16 16s-16-7.2-16-16c0-44.2 35.8-80 80-80c8.8 0 16 7.2 16 16s-7.2 16-16 16zm0 384c-44.2 0-80-35.8-80-80V416H272v16c0 44.2-35.8 80-80 80z"})})},5457:function(e,i,n){"use strict";n.d(i,{Z:function(){return d}});var t=n(5893),s=n(7294),l=n(2489),c=n(9417),r=n(5869),o=n(9427);function a(e){let{active:i,link:n,alternativeLink:s}=e,l={};return(i==n&&(l.textDecoration="underline"),s)?(0,t.jsx)("a",{style:l,href:"/".concat(s),target:"_blank",rel:"noopener noreferrer",children:n}):(0,t.jsx)("a",{style:l,href:"/".concat(n),children:n})}var h=e=>{let{active:i}=e,{darkmode:n,setDarkmode:h}=(0,s.useContext)(r.UserContext);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("header",{children:[(0,t.jsx)(a,{active:i,link:"about"}),(0,t.jsx)(a,{active:i,link:"blog"}),(0,t.jsx)(a,{active:i,link:"read"}),(0,t.jsx)(a,{active:i,link:"run"}),(0,t.jsx)(a,{active:i,link:"lang"}),(0,t.jsx)(a,{active:i,link:"cpu"}),(0,t.jsx)(a,{active:i,link:"gpu"}),(0,t.jsx)(a,{active:i,link:"opt"}),(0,t.jsx)(a,{active:i,link:"sw"}),(0,t.jsx)(a,{active:i,link:"ml"}),(0,t.jsx)(a,{active:i,link:"os",alternativeLink:"guidos/book/index.html"})]}),(0,t.jsxs)("div",{className:"box helper-icons",children:[(0,t.jsx)("a",{href:"/feed.xml",children:(0,t.jsx)(l.G,{icon:c.Fwd})}),(0,t.jsx)("a",{onClick:()=>{h(!n)},children:n?o._4:o.R2})]})]})},d=e=>{let{active:i,children:n}=e;return(0,s.useEffect)(()=>{let e=document.querySelectorAll("h1, h2, h3"),i=document.getElementsByClassName("toc");if(0==i.length)return;let n=i[0],t=n.querySelectorAll("a");for(let i of(t.length>0&&t[0].classList.add("active"),window.addEventListener("scroll",i=>{if(void 0!==e&&null!=e&&void 0!==t&&null!=t){let i=window.scrollY;t.forEach((e,i)=>{e.classList.remove("active")});for(var n=e.length-1;n>=0;n--){let s=e[n];if(null!=s&&i>s.offsetTop-75){t[n].classList.add("active");break}}}}),window.addEventListener("click",e=>{n.classList.remove("open")}),e))i.addEventListener("click",e=>{e.stopPropagation(),n.classList.add("open")})},[]),(0,t.jsxs)("div",{children:[(0,t.jsx)(h,{active:i}),(0,t.jsx)("main",{children:n})]})}},4509:function(e,i,n){"use strict";n.r(i),n.d(i,{default:function(){return o}});var t=n(5893),s=n(1151),l=n(5457);let c=function(e){let{children:i}=e;return(0,t.jsx)(l.Z,{active:"opt",children:(0,t.jsx)("div",{className:"content",children:i})})};function r(e){let i={a:"a",code:"code",h1:"h1",hr:"hr",li:"li",nav:"nav",ol:"ol",ul:"ul",...(0,s.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.nav,{className:"toc",children:(0,t.jsxs)(i.ol,{className:"toc-level toc-level-1",children:[(0,t.jsx)(i.li,{className:"toc-item toc-item-h1",children:(0,t.jsx)(i.a,{className:"toc-link toc-link-h1",href:"#algorithms-and-data-structures",children:"Algorithms and Data Structures"})}),(0,t.jsx)(i.li,{className:"toc-item toc-item-h1",children:(0,t.jsx)(i.a,{className:"toc-link toc-link-h1",href:"#cache-utilization",children:"Cache utilization"})}),(0,t.jsx)(i.li,{className:"toc-item toc-item-h1",children:(0,t.jsx)(i.a,{className:"toc-link toc-link-h1",href:"#concurrency",children:"Concurrency"})}),(0,t.jsx)(i.li,{className:"toc-item toc-item-h1",children:(0,t.jsx)(i.a,{className:"toc-link toc-link-h1",href:"#distributed-compute",children:"Distributed compute"})}),(0,t.jsx)(i.li,{className:"toc-item toc-item-h1",children:(0,t.jsx)(i.a,{className:"toc-link toc-link-h1",href:"#simd",children:"SIMD"})}),(0,t.jsx)(i.li,{className:"toc-item toc-item-h1",children:(0,t.jsx)(i.a,{className:"toc-link toc-link-h1",href:"#io",children:"I/O"})}),(0,t.jsx)(i.li,{className:"toc-item toc-item-h1",children:(0,t.jsx)(i.a,{className:"toc-link toc-link-h1",href:"#misc",children:"Misc"})}),(0,t.jsx)(i.li,{className:"toc-item toc-item-h1",children:(0,t.jsx)(i.a,{className:"toc-link toc-link-h1",href:"#tools",children:"Tools"})})]})}),"\n",(0,t.jsxs)(i.ol,{children:["\n",(0,t.jsx)(i.li,{children:"Reducing the number of branches"}),"\n",(0,t.jsx)(i.li,{children:"State machines instead of booleans"}),"\n",(0,t.jsx)(i.li,{children:"Faster copy (struct copy will be done using an optimized inline memcpy)"}),"\n",(0,t.jsxs)(i.li,{children:["Cheaper arithmetic","\n",(0,t.jsxs)(i.ol,{children:["\n",(0,t.jsx)(i.li,{children:"Avoid divisions by creating a table of 1/j and multiply by 1/j instead"}),"\n",(0,t.jsx)(i.li,{children:"Unsigned division is cheaper than signed division"}),"\n",(0,t.jsx)(i.li,{children:"Modulo often be transformed into if-statements"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(i.li,{children:"Fewer operations"}),"\n",(0,t.jsx)(i.li,{children:"Calculations in loops"}),"\n",(0,t.jsx)(i.li,{children:"Avoid casting"}),"\n",(0,t.jsx)(i.li,{children:"Remove if statements in loops if they are only run for one particular iteration"}),"\n",(0,t.jsx)(i.li,{children:"Use a small number of function arguments to avoid using the stack"}),"\n",(0,t.jsx)(i.li,{children:"Inline functions"}),"\n",(0,t.jsx)(i.li,{children:"Parallelism"}),"\n",(0,t.jsxs)(i.li,{children:["Using the ",(0,t.jsx)(i.code,{children:"restrict"})," keyword"]}),"\n",(0,t.jsx)(i.li,{children:"Double initialization"}),"\n",(0,t.jsx)(i.li,{children:"Useless initialization"}),"\n"]}),"\n",(0,t.jsx)(i.h1,{id:"algorithms-and-data-structures",children:"Algorithms and Data Structures"}),"\n",(0,t.jsx)(i.hr,{}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"Algorithms optimized for speed may consume more memory due to precomputed data structures or caching"}),"\n",(0,t.jsx)(i.li,{children:'Conversely, algorithms optimized for memory may have to compute values "on the fly" to avoid having them stored in a lookup table.'}),"\n",(0,t.jsx)(i.li,{children:"Not trivial as the best theoretical algorithm may be slower in practice due to how the program interacts with the memory!"}),"\n",(0,t.jsx)(i.li,{children:"EXAMPLE: Sorting"}),"\n"]}),"\n",(0,t.jsx)(i.h1,{id:"cache-utilization",children:"Cache utilization"}),"\n",(0,t.jsx)(i.hr,{}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:'Code optimized for speed "mus" exploit the CPU cache more effectively to get faster execution times. However, this is not trivial and platform dependent.'}),"\n",(0,t.jsx)(i.li,{children:"Memory hierarchy"}),"\n",(0,t.jsx)(i.li,{children:"Cache access"}),"\n",(0,t.jsx)(i.li,{children:"Data cache vs Text cache"}),"\n",(0,t.jsx)(i.li,{children:"Cache models and levels"}),"\n",(0,t.jsxs)(i.li,{children:["Spatial locality vs temporal locality","\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"Instructions and data are normally not accessed in a random order. The order is based on loops, subroutines, data structures, arrays etc."}),"\n",(0,t.jsx)(i.li,{children:"Stack vs Heap performance"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(i.li,{children:"Virtual memory"}),"\n",(0,t.jsx)(i.li,{children:"Cost effective?"}),"\n"]}),"\n",(0,t.jsx)(i.h1,{id:"concurrency",children:"Concurrency"}),"\n",(0,t.jsx)(i.hr,{}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"Keep the critical section small"}),"\n",(0,t.jsx)(i.li,{children:"Spin-lock vs semaphore"}),"\n",(0,t.jsx)(i.li,{children:"Lock-free"}),"\n",(0,t.jsx)(i.li,{}),"\n"]}),"\n",(0,t.jsx)(i.h1,{id:"distributed-compute",children:"Distributed compute"}),"\n",(0,t.jsx)(i.hr,{}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"Big data"}),"\n",(0,t.jsx)(i.li,{children:"MapReduce"}),"\n"]}),"\n",(0,t.jsx)(i.h1,{id:"simd",children:"SIMD"}),"\n",(0,t.jsx)(i.hr,{}),"\n",(0,t.jsx)(i.h1,{id:"io",children:"I/O"}),"\n",(0,t.jsx)(i.hr,{}),"\n",(0,t.jsx)(i.h1,{id:"misc",children:"Misc"}),"\n",(0,t.jsx)(i.hr,{}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"Loop unrolling"}),"\n",(0,t.jsx)(i.li,{children:"Pointer arithmetic"}),"\n",(0,t.jsx)(i.li,{children:"Compiler optimizations"}),"\n",(0,t.jsx)(i.li,{children:"Bitfields"}),"\n",(0,t.jsx)(i.li,{children:"Bitmaps"}),"\n",(0,t.jsx)(i.li,{children:"Register allocation"}),"\n",(0,t.jsx)(i.li,{children:"Floating point arithmetic"}),"\n",(0,t.jsx)(i.li,{children:"BigInt or 128 bits on 64 bit architecture"}),"\n",(0,t.jsx)(i.li,{children:"Inlining"}),"\n",(0,t.jsxs)(i.li,{children:["Branchless programming (Pipelining)","\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"Control hazards"}),"\n",(0,t.jsx)(i.li,{children:"Can lead to many stalls in the pipeline, normally the branch is predicted and stalled only if it turns out to be the wrong path. Much better if we can avoid the control statement altogether!"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(i.li,{children:"Alignment"}),"\n",(0,t.jsxs)(i.li,{children:["RISC vs CISC","\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"CISC => Requires fewer instructions, but these instructions require a complex implementation which will make all instructions slow, even the simple instructions."}),"\n",(0,t.jsx)(i.li,{children:"Compilers are often good at making fast code with simple instructions."}),"\n",(0,t.jsx)(i.li,{children:"The longest delay in the circuit determines the clock speed."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["Handcoding assembly for performance?","\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"Sometimes, but at the cost of efficiency and more lines of code increases the amounts of bugs"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(i.h1,{id:"tools",children:"Tools"}),"\n",(0,t.jsx)(i.hr,{}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"flamegraph"}),"\n"]})]})}function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,t.jsx)(c,{...e,children:(0,t.jsx)(r,{...e})})}},1151:function(e,i,n){"use strict";n.d(i,{a:function(){return l}});var t=n(7294);let s=t.createContext({});function l(e){let i=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}}},function(e){e.O(0,[976,603,774,888,179],function(){return e(e.s=2711)}),_N_E=e.O()}]);